var b={base:{backgroundColor:"#FFFFFF",color:"#3F3F3F",fontSize:"16px",fontFamily:'"Source Sans 3", "Source Sans Pro", system-ui, sans-serif',fontSmoothing:"antialiased","::placeholder":{color:"#899194"},padding:"0.25rem 0.5rem"},invalid:{color:"#e5424d",":focus":{color:"#303238"}}};document.addEventListener("DOMContentLoaded",function(){const l=JSON.parse(document.getElementById("org-card-data").textContent);JSON.parse(document.getElementById("plan-data").textContent),document.querySelectorAll(".card-field").forEach(e=>{const o=e.closest("form"),t=o.querySelector("#id_stripe_pk").value,n=o.querySelector("#id_stripe_token"),s=Stripe(t),c=s.elements().create("card",{style:b}),i=e.querySelector(".card-element");c.mount(i),c.on("change",function(a){const r=e.querySelector(".card-element-errors");a.error?r.textContent=a.error.message:r.textContent=""}),n.value="",o.addEventListener("submit",function(a){if(a.preventDefault(),n.value)return!0;const r=document.querySelector("input[name=payment_method]:checked");r!=null&&r.value=="existing-card"?o.submit():s.createToken(c).then(function(d){if(d.error){const v=e.querySelector(".card-element-errors");v.textContent=d.error.message}else n.value=d.token.id,o.submit()})})});function u(e){return{cardOnFileOptions:e.querySelectorAll(".card-on-file-option"),cardField:e.querySelector(".card-field"),paymentMethods:e.querySelector(".payment-methods"),saveCardCheckbox:e.querySelector('input[name="save_card"]').closest("label"),existingCardRadio:e.querySelector('input[value="existing-card"]'),newCardRadio:e.querySelector('input[value="new-card"]'),managePaymentLink:e.querySelector(".manage-payment-link"),newOrgInput:e.querySelector("#id_new_organization_name"),newOrgField:e.querySelector("#id_new_organization_name")?.closest("label"),submitButton:e.querySelector('button[type="submit"]')}}function h(e,o){const t=e.options[e.selectedIndex],n=t.getAttribute("data-individual")==="true",s=t.getAttribute("data-slug");n?o.href="/users/~payment/":s&&(o.href=`/organizations/${s}/payment/`),s?o.style.display="inline-block":o.style.display="none"}function g(e,o){const{cardOnFileOptions:t,existingCardRadio:n,newCardRadio:s}=o,f=l[e],c=!n.checked&&!s.checked;if(f){t.forEach(a=>{a.style.display="block";const r=a.querySelector(".card-info");r&&(r.textContent=`Use existing ${l[e].brand} ending in ${l[e].last4}`)}),c&&(n.checked=!0);const i=s?.closest(".new-card-option");i&&i.classList.remove("only-option")}else{t.forEach(a=>a.style.display="none"),(n.checked||c)&&(s.checked=!0);const i=s?.closest(".new-card-option");i&&i.classList.add("only-option")}}function y(e){const{cardField:o,saveCardCheckbox:t,existingCardRadio:n,newCardRadio:s}=e;n.checked?(o.style.display="none",t.style.display="none"):s.checked&&(o.style.display="block",t.style.display="block")}function S(e){const{paymentMethods:o,cardField:t,saveCardCheckbox:n,managePaymentLink:s}=e;o.style.display="none",t.style.display="none",n.style.display="none",s.style.display="none"}function p(e,o){const{newOrgField:t,newOrgInput:n}=o;!t||!n||(e==="new"?(t.classList.add("showField"),n.required=!0):(t.classList.remove("showField"),n.required=!1,n.value=""))}function m(e,o){const{submitButton:t}=o;t&&(e&&e!==""?t.disabled=!1:t.disabled=!0)}document.querySelectorAll(".org-select").forEach(e=>{e.addEventListener("change",function(){const o=this.closest("form"),t=this.value,n=u(o);t?(p(t,n),n.paymentMethods.style.display="block",h(this,n.managePaymentLink),g(t,n),y(n),m(t,n)):(p(t,n),S(n),m(t,n))}),e.dispatchEvent(new Event("change"))}),document.querySelectorAll('input[name="payment_method"]').forEach(e=>{e.addEventListener("change",function(){const o=this.closest("form"),t=u(o);y(t)}),e.dispatchEvent(new Event("change"))})});
