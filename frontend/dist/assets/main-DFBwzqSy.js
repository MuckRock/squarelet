(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();function l(t){return document.getElementById(t)}function a(t){return document.getElementById(t)!=null}function c(t,e,r){Array.isArray(e)?e.forEach(i=>t.addEventListener(i,r,!1)):t.addEventListener(e,r,!1)}function I(t,e="GET"){return new Promise((r,i)=>{const s=new XMLHttpRequest;s.onload=()=>{const n=s.status;n>=200&&n<300?r(s.responseText):i(`${n}: ${s.responseText}`)},s.open(e,t),s.send()})}function y(t){t.classList.remove("_cls-hide")}function C(t){t.classList.add("_cls-hide")}const w=40;class L{constructor(){this.filter=l("_id-filter"),this.close=l("_id-close"),this.results=l("_id-results"),this.page=1,this.morePages=!0,this.currentSearch="",this.currentPage=1,this.async=null,c(this.close,"click",()=>{this.filter.value="",this.page=1,this.morePages=!0,this.fetch("")}),c(this.filter,"input",()=>{this.resetAsync(),this.page=1,this.morePages=!0,this.fetch(this.filter.value)}),c(this.results,"scroll",()=>{const e=this.results.scrollTop+this.results.offsetHeight;this.page==this.currentPage&&e>this.results.scrollHeight-w&&this.nextPage()})}resetAsync(){this.async=null}clearResults(){for(;this.results.firstChild;)this.results.removeChild(this.results.firstChild)}render(e,r,i=""){r||this.clearResults();for(const s of e)this.addResult(s.name,s.slug,s.avatar,i);this.results.scrollHeight<this.results.offsetHeight+w&&this.nextPage()}addResult(e,r,i,s=""){const n=document.createElement("a");n.href=r;const o=document.createElement("div");o.className="_cls-result";const d=document.createElement("div");d.className="_cls-inlineAvatar";const p=document.createElement("img");if(p.src=i,p.width=22,p.height=22,d.appendChild(p),o.appendChild(d),s==""){const f=document.createElement("span");f.textContent=e,o.appendChild(f)}else{const f=s.toLowerCase();let u=e.toLowerCase();for(;;){let h=u.indexOf(f);if(h!=-1){const m=document.createElement("span");m.textContent=e.substring(0,h),o.appendChild(m);const g=document.createElement("b");g.textContent=e.substr(h,s.length),e=e.substr(h+s.length),u=u.substr(h+s.length),o.appendChild(g)}else{const m=document.createElement("span");m.textContent=e,o.appendChild(m);break}}}n.appendChild(o),this.results.appendChild(n)}fetch(e,r=!1){r||(this.results.scrollTop=0);const i=this.page;this.currentSearch=e,this.async=I(`autocomplete?q=${e}&page=${i}`).then(s=>{const n=JSON.parse(s);if(this.currentSearch==e&&this.page==i){const o=n.data;this.currentPage=i,o.length==0&&(this.morePages=!1),this.render(o,r,e),this.async=null}})}nextPage(){this.morePages&&(this.page++,this.fetch(this.filter.value,!0))}}class S{constructor(){this.dropdown=l("_id-profDropdown"),this.contents=l("_id-dropdownContents"),this.shim=l("_id-shim"),this.hidden=!0,c(this.dropdown,"click",()=>{this.hidden?this.show():this.hide()}),c(this.shim,"click",()=>{this.hide()})}show(){this.hidden=!1,this.dropdown.classList.add("_cls-active"),y(this.contents),y(this.shim)}hide(){this.hidden=!0,this.dropdown.classList.remove("_cls-active"),C(this.contents),C(this.shim)}}class F{constructor(){this.expandActions=Array.from(document.getElementsByClassName("_cls-expandAction")),this.expanded=!1,this.expandActions.forEach(e=>{c(e,"click",()=>{if(this.expanded){this.expanded=!1,e.firstChild.textContent="Expand";const i=e.closest("._cls-manageRow").nextSibling;i.parentElement.removeChild(i)}else{this.expanded=!0,e.firstChild.textContent="Collapse";const r=e.closest("._cls-manageRow"),i=document.createElement("div");i.className="_cls-manageRow _cls-iframeRow";const s=document.createElement("iframe");s.src=`/organizations/~charge/${e.dataset.charge}/`,i.appendChild(s),r.parentElement.insertBefore(i,r.nextSibling)}})})}}const b=window.Stripe,A={base:{color:"#3F3F3F",fontSize:"18px",fontFamily:"system-ui, sans-serif",fontSmoothing:"antialiased","::placeholder":{color:"#899194"}},invalid:{color:"#e5424d",":focus":{color:"#303238"}}};class U{constructor(){this.stripePk=l("id_stripe_pk"),this.planInput=l("id_plan"),this.ucofInput=l("id_use_card_on_file"),this.rcofInput=l("id_remove_card_on_file"),this.ccFieldset=l("_id-cardFieldset"),this.removeCardFieldset=l("_id-removeCardFieldset"),this.planInfoElem=l("_id-planInfo"),this.planProjection=l("_id-planProjection"),this.cardContainer=l("card-container"),this.receiptEmails=l("_id-receiptEmails"),this.totalCost=l("_id-totalCost"),this.costBreakdown=l("_id-costBreakdown"),this.maxUsersElem=l("id_max_users"),this.planInfo=JSON.parse(this.planInfoElem.textContent),this.setupMaxUsersField(),this.setupCardOnFileField(),this.setupReceiptEmails(),this.setupStripe(),this.updateAll()}receiptResize(){this.receiptEmails.style.height="5px",this.receiptEmails.style.height=this.receiptEmails.scrollHeight+"px"}getPlan(){return this.planInfo[this.planInput.value]||this.planInfo[""]}updateTotalCost(){if(this.totalCost==null)return;const e=this.getPlan(),r=`${e.base_price+(this.maxUsers-e.minimum_users)*e.price_per_user}`,i=e.annual?"year":"month",s=`$${r} / ${i}`;this.totalCost.textContent=s;let n=`$${e.base_price} (base price)`;this.maxUsers!=0&&(this.maxUsers-e.minimum_users==0?(n+=` with ${e.minimum_users} resource block${e.minimum_users!=1?"s":""} included`,e.price_per_user!=0&&(n+=` ($${e.price_per_user} per additional resouece block)`)):n+=` with ${e.minimum_users} resource block${e.minimum_users!=1?"s":""} included and ${this.maxUsers-e.minimum_users} extra resource blocks
          at $${e.price_per_user} each`),this.costBreakdown.textContent=n}updatePlanInput(){const e=this.getPlan();this.updateTotalCost(),$(e)?(this.ccFieldset!=null&&(this.ccFieldset.style.display=""),this.removeCardFieldset!=null&&(this.removeCardFieldset.style.display="none")):(this.ccFieldset!=null&&(this.ccFieldset.style.display="none"),this.removeCardFieldset!=null&&(this.removeCardFieldset.style.display="")),_(e)?this.planProjection!=null&&(this.planProjection.style.display="none"):this.planProjection!=null&&(this.planProjection.style.display=""),this.updateAll(!1)}updateMaxUsers(){if(this.maxUsersElem==null)return;this.maxUsers=parseInt(this.maxUsersElem.value);const e=parseInt(this.maxUsersElem.min);this.maxUsers<e&&(this.maxUsersElem.value=`${e}`,this.maxUsers=e)}updateSavedCC(){if(this.ucofInput==null){this.cardContainer!=null&&(this.cardContainer.style.display="");return}document.querySelector("input[name=use_card_on_file]:checked").value=="True"&&this.ccFieldset.style.display===""?this.cardContainer!=null&&(this.cardContainer.style.display="none"):this.cardContainer!=null&&(this.cardContainer.style.display="")}updateAll(e=!0){this.updateMaxUsers(),this.updateSavedCC(),e&&this.updatePlanInput()}setupMaxUsersField(){if(a("id_max_users")){const e=this.maxUsersElem;this.maxUsers=parseInt(e.value),c(e,"blur",()=>{this.updateAll()})}else{const e=this.getPlan();this.maxUsers=e.minimum_users}}setupCardOnFileField(){a("id_use_card_on_file")&&c(this.ucofInput,"input",()=>{this.updateAll()})}setupReceiptEmails(){this.receiptEmails!=null&&(this.receiptEmails.rows=2,c(this.receiptEmails,"input",()=>this.receiptResize()),this.receiptResize())}setupStripe(){if(a("card-element")){const e=b(this.stripePk.value),i=e.elements().create("card",{style:A});i.mount("#card-element"),i.addEventListener("change",n=>{const o=n,d=document.getElementById("card-errors");o.error?d.textContent=o.error.message:d.textContent=""}),document.getElementById("id_stripe_token").value="",this.planInput.addEventListener("input",()=>{this.updateAll()}),document.getElementById("stripe-form").addEventListener("submit",n=>{const o=document.querySelector("input[name=use_card_on_file]:checked"),d=o!=null&&o.value=="True",p=this.getPlan(),f=document.querySelector("#card-element").classList.contains("StripeElement--empty");_(p)&&f||d||(n.preventDefault(),e.createToken(i).then(function(u){if(u.error){const h=document.getElementById("card-errors");h.textContent=u.error.message}else k(u.token)}))})}}}function k(t){const e=document.getElementById("id_stripe_token");e.value=t.id,document.getElementById("stripe-form").submit()}function _(t){return t.base_price==0&&t.price_per_user==0}function $(t){return!_(t)&&!t.annual}function v(t){const e=t.querySelector("._cls-erh--resourceList"),r=t.querySelector("._cls-scroll-control--left"),i=t.querySelector("._cls-scroll-control--right");return[e,r,i]}function R(t){const e=Array.from((t==null?void 0:t.querySelectorAll("li"))??[]);return e.reduce((i,s)=>i+s.clientWidth,0)/e.length}function P(t){if(!t)return[];let e=t.scrollWidth,r=t.scrollLeft,i=t.clientWidth+r;return[e,r,i]}function B(t,e,r){t[0]&&(t[0].disabled=e),t[1]&&(t[1].disabled=r)}function E(t){const[e,r,i]=v(t),[s,n,o]=P(e);B([r,i],n===0,o===s)}function x(t,e,r){if(!t)return;const[i]=P(t);e==="left"?t.scrollLeft=Math.max(t.scrollLeft-r,0):t.scrollLeft=Math.min(t.scrollLeft+r,i)}function T(){document.querySelectorAll("section._cls-erh--category").forEach(e=>{const[r,i,s]=v(e),n=R(r);E(e),r==null||r.addEventListener("scroll",()=>E(e)),i==null||i.addEventListener("click",()=>x(r,"left",n)),s==null||s.addEventListener("click",()=>x(r,"right",n))})}a("_id-profDropdown")&&new S;a("_id-autocomplete")&&new L;a("_id-resendVerification");a("_id-receiptsTable")&&new F;a("id_stripe_pk")&&new U;a("_id-erh-catalog")&&T();
